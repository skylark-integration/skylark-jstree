{"version":3,"sources":["plugin/changed.js"],"names":["define","langx","browser","eventer","noder","geom","velm","$","jstree","sbswt","plugins","changed","options","parent","last","this","trigger","ev","data","i","j","replace","selected","deselected","tmp","length","push","slice","call","refresh","skip_loading","forget_state","apply","arguments"],"mappings":";;;;;;;AAAAA,QACE,sBACA,wBACA,wBACA,sBACA,qBACA,qBACA,sBACA,UACA,wBACA,SAASC,EAAMC,EAAQC,EAAQC,EAAMC,EAAKC,EAAKC,EAAEC,EAAOC,GACzD,YAEA,KAAGF,EAAEC,OAAOE,QAAQC,QAiDpB,MA/CAJ,GAAEC,OAAOE,QAAQC,QAAU,SAAUC,EAASC,GAC7C,GAAIC,KACJC,MAAKC,QAAU,SAAUC,EAAIC,GAC5B,GAAIC,GAAGC,CAIP,IAHIF,IACHA,MAE+B,YAA7BD,EAAGI,QAAQ,UAAU,IAAmB,CAC1CH,EAAKP,SAAYW,YAAeC,cAChC,IAAIC,KACJ,KAAIL,EAAI,EAAGC,EAAIN,EAAKW,OAAQN,EAAIC,EAAGD,IAClCK,EAAIV,EAAKK,IAAM,CAEhB,KAAIA,EAAI,EAAGC,EAAIF,EAAKI,SAASG,OAAQN,EAAIC,EAAGD,IACvCK,EAAIN,EAAKI,SAASH,IAIrBK,EAAIN,EAAKI,SAASH,IAAM,EAHxBD,EAAKP,QAAQW,SAASI,KAAKR,EAAKI,SAASH,GAM3C,KAAIA,EAAI,EAAGC,EAAIN,EAAKW,OAAQN,EAAIC,EAAGD,IACd,IAAjBK,EAAIV,EAAKK,KACXD,EAAKP,QAAQY,WAAWG,KAAKZ,EAAKK,GAGpCL,GAAOI,EAAKI,SAASK,QAatBd,EAAOG,QAAQY,KAAKb,KAAME,EAAIC,IAE/BH,KAAKc,QAAU,SAAUC,EAAcC,GAEtC,MADAjB,MACOD,EAAOgB,QAAQG,MAAMjB,KAAMkB,aAI7B1B","file":"../../plugin/changed.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/velm\",\n  \"skylark-utils/query\",\n  \"../tree\",\n  \"skylark-ui-swt/sbswt\"\n],function(langx,browser,eventer,noder,geom,velm,$,jstree,sbswt){\n\t\"use strict\";\n\n\tif($.jstree.plugins.changed) { return; }\n\n\t$.jstree.plugins.changed = function (options, parent) {\n\t\tvar last = [];\n\t\tthis.trigger = function (ev, data) {\n\t\t\tvar i, j;\n\t\t\tif(!data) {\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif(ev.replace('.jstree','') === 'changed') {\n\t\t\t\tdata.changed = { selected : [], deselected : [] };\n\t\t\t\tvar tmp = {};\n\t\t\t\tfor(i = 0, j = last.length; i < j; i++) {\n\t\t\t\t\ttmp[last[i]] = 1;\n\t\t\t\t}\n\t\t\t\tfor(i = 0, j = data.selected.length; i < j; i++) {\n\t\t\t\t\tif(!tmp[data.selected[i]]) {\n\t\t\t\t\t\tdata.changed.selected.push(data.selected[i]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ttmp[data.selected[i]] = 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(i = 0, j = last.length; i < j; i++) {\n\t\t\t\t\tif(tmp[last[i]] === 1) {\n\t\t\t\t\t\tdata.changed.deselected.push(last[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlast = data.selected.slice();\n\t\t\t}\n\t\t\t/**\n\t\t\t * triggered when selection changes (the \"changed\" plugin enhances the original event with more data)\n\t\t\t * @event\n\t\t\t * @name changed.jstree\n\t\t\t * @param {Object} node\n\t\t\t * @param {Object} action the action that caused the selection to change\n\t\t\t * @param {Array} selected the current selection\n\t\t\t * @param {Object} changed an object containing two properties `selected` and `deselected` - both arrays of node IDs, which were selected or deselected since the last changed event\n\t\t\t * @param {Object} event the event (if any) that triggered this changed event\n\t\t\t * @plugin changed\n\t\t\t */\n\t\t\tparent.trigger.call(this, ev, data);\n\t\t};\n\t\tthis.refresh = function (skip_loading, forget_state) {\n\t\t\tlast = [];\n\t\t\treturn parent.refresh.apply(this, arguments);\n\t\t};\n\t};\n\n\treturn $;\n});"]}